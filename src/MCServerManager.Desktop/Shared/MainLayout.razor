@using MCServerManager.Desktop.Services
@inherits LayoutComponentBase
@inject CredentialService CredentialService
@inject NavigationManager NavigationManager

<MudThemeProvider IsDarkMode="true"/>
<MudDialogProvider CloseButton="true"
				   CloseOnEscapeKey="true"
				   FullWidth="true"
				   MaxWidth="MaxWidth.Medium"
				   Position="DialogPosition.TopCenter"/>
<MudSnackbarProvider/>

<MudLayout>
	<MudAppBar Elevation="0" Dense="true" Fixed="true" DisableGutters="true" Class="px-1">
		<MudToggleIconButton @bind-Toggled="@_drawerOpen"
							 Icon="@Icons.Material.Filled.Menu"
							 ToggledIcon="@Icons.Material.Filled.MenuOpen"/>
		<MudSpacer/>
		<MudIconButton Color="Color.Inherit"
					   Icon="@Icons.Custom.Brands.GitHub"
					   Link="https://github.com/Tabizzz/MCServerManager/tree/desktop"
					   Target="_blank"/>
	</MudAppBar>
	<MudDrawer @bind-Open="@_drawerOpen"
			   ClipMode="DrawerClipMode.Always"
			   Elevation="1"
			   PreserveOpenState="true"
			   Variant="DrawerVariant.Mini"
			   Width="150px">
		<NavMenu/>
	</MudDrawer>
	<MudMainContent>
		<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="pt-4">
			<CascadingValue Value="this">
				@if (!RequireSftp || (RequireSftp && CredentialService.SftpCredentials.IsValid))
				{
					@Body
				}
				else
				{
					<MudAlert Severity="Severity.Error">
						You need to specify SFTP Credentials before access to this page!
						<MudButton Variant="Variant.Text"
						           EndIcon="@Icons.Material.Filled.Login"
						           Color="Color.Secondary"
						           Style="text-transform:none"
						           OnClick="GotoAuth">
							Go to Auth
						</MudButton>
					</MudAlert>
				}
			</CascadingValue>
		</MudContainer>
	</MudMainContent>
</MudLayout>
